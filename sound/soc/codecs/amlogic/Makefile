KBUILD_CFLAGS += -Wlarger-than=28792
#KBUILD_CFLAGS += -Wstack-usage=1856

#Amlogic
snd-soc-dummy_codec-objs := dummy_codec.o
snd-soc-pdm-dummy-objs := pdm_dummy.o
snd-soc-pcm2bt-objs  := pcm2bt.o
snd-soc-aml_t9015-objs := aml_codec_t9015.o
snd-soc-aml_t9015s-objs := aml_codec_t9015S.o
snd-soc-pmu3-objs := aml_pmu3.o
snd-soc-aml_codec_txlx_acodec-objs := aml_codec_txlx_acodec.o
snd-soc-aml_codec_tl1_acodec-objs  := aml_codec_tl1_acodec.o
snd-soc-aml_codec_pa1-objs := aml_codec_pa1.o

#Third part codecs
snd-soc-tas5782m-objs := tas5782m.o
snd-soc-tas5707-objs := tas5707.o
snd-soc-tlv320adc3101-objs := tlv320adc3101.o
snd-soc-pcm186x-objs := pcm186x.o pcm186x-i2c.o pcm186x-spi.o
snd-soc-ssm3515-objs := ssm3515.o
snd-soc-ssm3525-objs := ssm3525.o
snd-soc-ad82584f-objs := ad82584f.o
snd-soc-ad82587d-objs := ad82587d.o
snd-soc-tas5805-objs := tas5805.o
snd-soc-tas5805m-objs := tas5805m.o
snd-soc-tlv320adc5140-objs := tlv320adc5140.o
snd-soc-ad82128-objs := ad82128.o
# Amlogic
obj-$(CONFIG_AMLOGIC_SND_CODEC_DUMMY_CODEC) += snd-soc-dummy_codec.o
obj-$(CONFIG_AMLOGIC_SND_CODEC_PDM_DUMMY_CODEC) += snd-soc-pdm-dummy.o
obj-$(CONFIG_AMLOGIC_SND_CODEC_PCM2BT) += snd-soc-pcm2bt.o
obj-$(CONFIG_AMLOGIC_SND_CODEC_AMLT9015) += snd-soc-aml_t9015.o
obj-$(CONFIG_AMLOGIC_SND_CODEC_AMLT9015S) += snd-soc-aml_t9015s.o
obj-$(CONFIG_AMLOGIC_SND_CODEC_PMU3) += snd-soc-pmu3.o
obj-$(CONFIG_AMLOGIC_SND_CODEC_TXLX_ACODEC) += snd-soc-aml_codec_txlx_acodec.o
obj-$(CONFIG_AMLOGIC_SND_CODEC_TL1_ACODEC)  += snd-soc-aml_codec_tl1_acodec.o
obj-$(CONFIG_AMLOGIC_SND_CODEC_PA1)  += snd-soc-aml_codec_pa1.o

#Third part codecs
obj-$(CONFIG_AMLOGIC_SND_SOC_TAS5782M) += snd-soc-tas5782m.o
obj-$(CONFIG_AMLOGIC_SND_SOC_TAS5707) += snd-soc-tas5707.o
obj-$(CONFIG_AMLOGIC_SND_SOC_TLV320ADC3101) += snd-soc-tlv320adc3101.o
obj-$(CONFIG_AMLOGIC_SND_SOC_PCM186X) += snd-soc-pcm186x.o
obj-$(CONFIG_AMLOGIC_SND_SOC_SSM3515) += snd-soc-ssm3515.o
obj-$(CONFIG_AMLOGIC_SND_SOC_SSM3525) += snd-soc-ssm3525.o
obj-$(CONFIG_AMLOGIC_SND_SOC_TAS575X) += tas575x.o
obj-$(CONFIG_AMLOGIC_SND_SOC_ES7243) += es7243.o
obj-$(CONFIG_AMLOGIC_SND_SOC_AD82584F) += ad82584f.o
obj-$(CONFIG_AMLOGIC_SND_SOC_AD82587D) += ad82587d.o
obj-$(CONFIG_AMLOGIC_SND_SOC_CS42528) += cs42528.o
obj-$(CONFIG_AMLOGIC_SND_SOC_TAS5805) += snd-soc-tas5805.o
obj-$(CONFIG_AMLOGIC_SND_SOC_TAS5805m) += snd-soc-tas5805m.o
obj-$(CONFIG_AMLOGIC_SND_SOC_TLV320ADC5140) += snd-soc-tlv320adc5140.o
obj-$(CONFIG_AMLOGIC_SND_SOC_AD82128) += snd-soc-ad82128.o


KBUILD_CFLAGS_MODULE += $(GKI_EXT_MODULE_PREDEFINE)

all:
	@$(MAKE) -C $(KERNEL_SRC) M=$(M)  modules $(GKI_EXT_MODULE_CONFIG)
	#@$(MAKE) -C $(KERNEL_SRC) M=$(M)/optee --trace  modules

modules_install:
	@echo "$(MAKE) INSTALL_MOD_STRIP=1 M=$(M) -C $(KERNEL_SRC) modules_install"
#	@$(MAKE) INSTALL_MOD_STRIP=1 M=$(M) -C $(KERNEL_SRC) modules_install
#	mkdir -p ${OUT_DIR}/../vendor_lib
#	cd ${OUT_DIR}/$(M)/; find -name "*.ko" -exec cp {} ${OUT_DIR}/../vendor_lib/ \;


clean:
	$(MAKE) -C $(KERNEL_SRC) M=$(M) clean
